<title>Chatroom</title>

<head>
    <link rel="stylesheet" href="/styles.css">
    <script>
        // const roomId = window.location.pathname.split('/').pop();
        // console.log("Room ID:", roomId);

        function scrollToBottom() {
            const chatContainer = document.getElementById('chatMessages');
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
        window.onload = scrollToBottom;
    </script>
</head>

<%- include("templates/header") %>


    <div id="chatMessages" style="overflow-y: auto; max-height: 500px; padding-right: 10px;">
        <% messages.forEach(message=> { %>
            <div class="message-item <%= message.user_id === user_id ? 'user-message' : 'other-message' %>">
                <div class="message-header">
                    <span class="username">
                        <%= message.username %>
                    </span>
                    <span class="timestamp">
                        <%= new Date(message.sent_time).toLocaleString('en-US', { hour: '2-digit' , minute: '2-digit' ,
                            hour12: true }) %>
                    </span>
                </div>
                <div class="message-text" style="color: brown;">
                    <%= message.text %>
                </div>
            </div>
            <% }); %>
    </div>
    <div>
        <div id="chatInput">
            <form action="/sendMessage" method="POST">
                <input type="hidden" name="roomId" value="<%= room_id %>">
                <input type="text" id="messageInput" name="message" placeholder="Type a message..." required>
                <button type="submit">Send</button>
            </form>
        </div><button onclick="window.history.back()" style="float: right;">Go Back</button>
    </div>


    <%- include("templates/footer") %>